<html>
<head>
  <title>HTTP访问</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303502 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="321"/>
<h1>HTTP访问</h1>

<div>
<span><div>一：基于TCP/IP通信协议使用serversocket，Socket来建立网络通信    JAVA基础</div><div>     <span style="color: rgb(255, 0, 0);"><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">TCP/IP协议在通信的两端各建立一个socket，从而形成网络虚拟链路</span></span></div><div>    <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span style="color: rgb(255, 0, 0);"> java使用Socket对象来代表两端的通信接口</span></span>，并且通过Socket来产生I/O流来进行网络通信</div><div>     </div><div>     1.1tcp/ip协议基础</div><div>          ip协议是Internet的关键协议，通过IP协议使internet成为可以互相连接不同电脑的网络，<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">ip协议<span style="color: rgb(255, 0, 0);">只负责</span>将消息分割成一个个小包然后发送和接收；<span style="color: rgb(255, 0, 0);">ip协议保证了计算机之间可以发送和接收数据</span></span></div><div>          tcp协议被称为端对端协议， tcp协议会让两台计算机之间建立一个连接（用于发送和接收数据的虚拟链路），<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">tcp协议<span style="color: rgb(255, 0, 0);">只负责</span>收集一个个的数据包然后将其按适当顺序放好传送，在接收端收到后再将其正确返回</span>；<span style="color: rgb(255, 0, 0);">tcp保证了数据的完整和准确</span></div><div>         <span style="color: rgb(255, 0, 0);"> tcp使用重发机制</span>，如果没有收到另一端返回的确认信息，则会重新发送</div><div><br/></div><div>          <img src="HTTP访问_files/Image.png" type="image/png" style="cursor: default; height: auto;"/></div><div>    1.2 使用ServerSocket创建TCP服务器端</div><div>          <span style="color: rgb(255, 70, 53);">在tcp通信的两个实体之间看起来并没有服务器和客户端之分，但那是在已经建立好虚拟链路的情况下（android疯狂讲义P562  13.1.2）</span></div><div><span style="color: rgb(255, 70, 53);">          所有必须有一个实体先做出主动姿态，主动的来接收其他通信实体的连接请求</span></div><div><span style="color: rgb(255, 70, 53);">          1.2.1：服务器端 ：java中能接收其他通信实体连接请求的类是 ServerSocket</span></div><div><span style="color: rgb(255, 70, 53);">                         Serversocket包含一个监听来自客户端连接请求的方法 ：</span></div><div><span style="color: rgb(255, 70, 53);">                                   <span style="color: rgb(166, 0, 196);">Socket accept（）：如果接收到连接请求，将返回一个与连接客户端对应的Socket,否则将一                                       直处于 等待状态，线程被柱塞</span></span></div><div><span style="color: rgb(166, 0, 196);">                         </span>为了创建Serversocket对象，java提供了几个构造器</div><div><span style="color: rgb(166, 0, 196);">                                   <span style="color: rgb(134, 0, 164);">ServerSocket(int port)：指定监听端口  0~65535</span></span></div><div><span style="color: rgb(166, 0, 196);">                                   </span><span style="color: rgb(166, 0, 196);"><span style="color: rgb(134, 0, 164);">ServerSocket(int port，int backlog) :增加一个用来改变连接队列长度的参数</span></span></div><div><span style="color: rgb(166, 0, 196);">                                   </span><span style="color: rgb(166, 0, 196);"><span style="color: rgb(134, 0, 164);">ServerSocket(int port，int backlog，inetAddress localaddr):在服务器存在多个IP地址时，                                         可以通过localaddr这个参数来指定将ServerSocket绑定到指定的ip地址</span></span></div><div><span style="color: rgb(134, 0, 164);">                         例子：</span></div><div><span style="color: rgb(134, 0, 164);">                                           <span style="color: rgb(26, 173, 224);">//创建</span></span><span style="color: rgb(26, 173, 224);">ServerSocket</span></div><div><span style="color: rgb(26, 173, 224);">                                            </span><span style="color: rgb(26, 173, 224);">ServerSocket server=new </span><span style="color: rgb(26, 173, 224);">ServerSocket(4000);</span></div><div><span style="color: rgb(26, 173, 224);">                                             //循环监听</span></div><div><span style="color: rgb(26, 173, 224);">                                               while(true){</span></div><div><span style="color: rgb(26, 173, 224);">                                                       Socket  s=server.accept();<br/></span></div><div><span style="color: rgb(26, 173, 224);">                                                            //开始使用</span><span style="color: rgb(26, 173, 224);">Socket通信</span></div><div><span style="color: rgb(26, 173, 224);">                                             }<br/></span></div><div><span style="color: rgb(134, 0, 164);"><br/></span></div><div><span style="color: rgb(255, 70, 53);">          1.2.2：客户端：通常使用Socket类的构造器来连接到指定服务器<br/></span></div><div><span style="color: rgb(255, 70, 53);">                         </span>为了创建Socket对象，java提供了几个构造器</div><div>                                    <span style="color: rgb(26, 144, 185);"> Socket（inetAddress/String remoteAddress,int port）:创建连接到指定主机，远程端口的Socket，该构造器没有指定本地地址，本地端口，默认使用本地主机的默认IP地址，默认使用系统动态分配的端口。</span></div><div><span style="color: rgb(26, 144, 185);">                                      Socket(inetAddress/String remoteAddress,int port,inetAddress loocaladdr,int localport)  :创建连接到指定远程主机，远程端口的Socket，并制定本地IP地址和本地端口，适用于本地主机有多少个IP地址的情形。</span></div><div><span style="color: rgb(26, 144, 185);">                                   通常使用String对象来指定远程主机的IP地址，当本地主机只有一个IP时使用第一个更方便</span></div><div><span style="color: rgb(26, 144, 185);">                         例子：</span></div><div><span style="color: rgb(26, 144, 185);">                                             //创建连接到指定地址和端口的Socket</span></div><div><span style="color: rgb(26, 144, 185);">                                             Socket s =new Socket(&quot;139.129.132.128&quot;,4000);</span></div><div><span style="color: rgb(26, 144, 185);">                                              //使用Socket通信</span></div><div><span style="color: rgb(26, 144, 185);">-----------------------------------------------------------------------------------------------------------------</span></div><div><span style="color: rgb(26, 144, 185);"><br/></span></div><div><span style="color: rgb(26, 144, 185);">当客户端和服务器端产生了对应的Socket后，就无需再区分服务器和客户端了，而是通过各自的Socket来通信，</span></div><div><span style="color: rgb(26, 144, 185);">Socket提供了两个方法来获取输出流和输入流</span></div><div><span style="color: rgb(26, 144, 185);">         InputStream getinputStream（） ：返回该Socket对象对应的输入流，让程序通过该输入流从Socket中取出数据。</span></div><div><span style="color: rgb(26, 144, 185);">          </span></div><div><span style="color: rgb(26, 144, 185);">         OutputStream getOutputStream() : 返回该Socket对象对应的输出流，让程序通过该输出流向Socket输出数据。<br/></span></div><div>                                      </div><div>          </div></span>
</div></body></html> 