<html>
<head>
  <title>Android 实现个性的ViewPager切换动画 实战PageTransformer（兼容Android3.0以下）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303502 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="737"/>
<h1>Android 实现个性的ViewPager切换动画 实战PageTransformer（兼容Android3.0以下）</h1>

<div>
<span><div><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">转载请标明出处：</span><a href="http://blog.csdn.net/lmj623565791/article/details/40411921" style="font-family: 'sans serif', tahoma, verdana, helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" target="_blank">http://blog.csdn.net/lmj623565791/article/details/40411921</a><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">，本文出自：</span><a href="http://blog.csdn.net/lmj623565791" style="font-family: 'sans serif', tahoma, verdana, helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" target="_blank">【张鸿洋的博客】</a><h1 style="font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; background-color: rgb(255, 255, 255);"><img src="http://blog.n8n.cn/wp-content/plugins/kindeditor-for-wordpress/themes/common/anchor.gif" style="border: 1px dashed rgb(102, 102, 102); width: 16px; height: 16px;"></img>1、概述</h1><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">之前写过一篇博文：<span style="color: rgb(0, 0, 153); font-family: Arial;"><a href="http://blog.csdn.net/lmj623565791/article/details/38026503" target="_blank">Android 自定义 ViewPager 打造千变万化的图片切换效果</a>。</span><span style="font-family: Arial;">有兄弟提出，ViewPager自带了一个<a href="http://blog.csdn.net/lmj623565791/article/details/38026503" target="_blank">setPageTransformer</a>用于设置切换动画~</span></p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);"><span style="font-family: Arial;">本篇博文，将：</span></p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);"><span style="font-family: Arial;">1、介绍如何使用<a href="http://blog.csdn.net/lmj623565791/article/details/38026503" target="_blank">setPageTransformer</a>设置切换动画；</span></p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);"><span style="font-family: Arial;">2、自定义PageTransformer实现个性的切换动画；</span></p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);"><span style="font-family: Arial;">3、该方法在SDK11以下的版本不起作用，我们会对其做一定修改，让其向下兼容。</span></p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">官方示例地址：http://developer.android.com/training/animation/screen-slide.html 有兴趣的可以去看看~~</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);"><br/></p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">好了，下面开始编写代码~~</p><h1 style="font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; background-color: rgb(255, 255, 255);"><img src="http://blog.n8n.cn/wp-content/plugins/kindeditor-for-wordpress/themes/common/anchor.gif" style="border: 1px dashed rgb(102, 102, 102); width: 16px; height: 16px;"></img>2、setPageTransformer的使用</h1><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">首先我们迅速的实现一个传统的ViewPager效果~</p></div><div><br/></div><div style="font-style: normal; font-variant: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><div><span style="color: rgb(85, 85, 85);"><span style="font-size: 20px;"><span style="font-family: 'microsoft yahei';"><b><img src="http://blog.n8n.cn/wp-content/plugins/kindeditor-for-wordpress/themes/common/anchor.gif" style="border: 1px dashed rgb(102, 102, 102); width: 16px; height: 16px;"></img>1、布局文件</b></span></span></span></div><div><span style="color: rgb(85, 85, 85);"><span style="font-size: 20px;"><span style="font-family: 'microsoft yahei';"><b><br/></b></span></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div><b>- &lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</b></div><div><b>-     xmlns:tools=&quot;http://schemas.android.com/tools&quot;</b></div><div><b>-     android:layout_width=&quot;match_parent&quot;</b></div><div><b>-     android:layout_height=&quot;match_parent&quot; &gt;</b></div><div><b>-</b></div><div><b>-     &lt;android.support.v4.view.ViewPager</b></div><div><b>-         android:id=&quot;@+id/id_viewpager&quot;</b></div><div><b>-         android:layout_width=&quot;fill_parent&quot;</b></div><div><b>-         android:layout_height=&quot;fill_parent&quot; /&gt;</b></div><div><b>-</b></div><div><b>- &lt;/RelativeLayout&gt;</b></div></div><div><br/></div><div style="font-style: normal; font-variant: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><div><span style="color: rgb(85, 85, 85);"><span style="font-size: 20px;"><span style="font-family: 'microsoft yahei';"><b>2、MainActivity</b></span></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div><b>- package com.zhy.demo_zhy_08_viewpageranim;</b></div><div><b>-</b></div><div><b>- import java.util.ArrayList;</b></div><div><b>- import java.util.List;</b></div><div><b>-</b></div><div><b>- import android.app.Activity;</b></div><div><b>- import android.os.Bundle;</b></div><div><b>- import android.support.v4.view.PagerAdapter;</b></div><div><b>- import android.support.v4.view.ViewPager;</b></div><div><b>- import android.view.View;</b></div><div><b>- import android.view.ViewGroup;</b></div><div><b>- import android.view.Window;</b></div><div><b>- import android.widget.ImageView;</b></div><div><b>- import android.widget.ImageView.ScaleType;</b></div><div><b>-</b></div><div><b>- public class MainActivity extends Activity</b></div><div><b>- {</b></div><div><b>-     private ViewPager mViewPager;</b></div><div><b>-     private int[] mImgIds = new int[] { R.drawable.guide_image1,</b></div><div><b>-             R.drawable.guide_image2, R.drawable.guide_image3 };</b></div><div><b>-     private List&lt;ImageView&gt; mImageViews = new ArrayList&lt;ImageView&gt;();</b></div><div><b>-</b></div><div><b>-     @Override</b></div><div><b>-     protected void onCreate(Bundle savedInstanceState)</b></div><div><b>-     {</b></div><div><b>-         super.onCreate(savedInstanceState);</b></div><div><b>-</b></div><div><b>-         requestWindowFeature(Window.FEATURE_NO_TITLE);</b></div><div><b>-         setContentView(R.layout.activity_main);</b></div><div><b>-</b></div><div><b>-         initData();</b></div><div><b>-</b></div><div><b>-         mViewPager = (ViewPager) findViewById(R.id.id_viewpager);</b></div><div><b>-</b></div><div><b>-         mViewPager.setAdapter(new PagerAdapter()</b></div><div><b>-         {</b></div><div><b>-             @Override</b></div><div><b>-             public Object instantiateItem(ViewGroup container, int position)</b></div><div><b>-             {</b></div><div><b>-</b></div><div><b>-                 container.addView(mImageViews.get(position));</b></div><div><b>-                 return mImageViews.get(position);</b></div><div><b>-             }</b></div><div><b>-</b></div><div><b>-             @Override</b></div><div><b>-             public void destroyItem(ViewGroup container, int position,</b></div><div><b>-                     Object object)</b></div><div><b>-             {</b></div><div><b>-</b></div><div><b>-                 container.removeView(mImageViews.get(position));</b></div><div><b>-             }</b></div><div><b>-</b></div><div><b>-             @Override</b></div><div><b>-             public boolean isViewFromObject(View view, Object object)</b></div><div><b>-             {</b></div><div><b>-                 return view == object;</b></div><div><b>-             }</b></div><div><b>-</b></div><div><b>-             @Override</b></div><div><b>-             public int getCount()</b></div><div><b>-             {</b></div><div><b>-                 return mImgIds.length;</b></div><div><b>-             }</b></div><div><b>-         });</b></div><div><b>-</b></div><div><b>-     }</b></div><div><b>-</b></div><div><b>-     private void initData()</b></div><div><b>-     {</b></div><div><b>-         for (int imgId : mImgIds)</b></div><div><b>-         {</b></div><div><b>-             ImageView imageView = new ImageView(getApplicationContext());</b></div><div><b>-             imageView.setScaleType(ScaleType.CENTER_CROP);</b></div><div><b>-             imageView.setImageResource(imgId);</b></div><div><b>-             mImageViews.add(imageView);</b></div><div><b>-         }</b></div><div><b>-     }</b></div><div><b>-</b></div><div><b>- }</b></div></div><div><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">好了，这样一个传统ViewPager就实现了~~大家对上面代码应该不会有任何陌生的感觉~运行效果也不用贴图了，大家肯定知道~~</span><h2 style="font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; background-color: rgb(255, 255, 255);"><img src="http://blog.n8n.cn/wp-content/plugins/kindeditor-for-wordpress/themes/common/anchor.gif" style="border: 1px dashed rgb(102, 102, 102); width: 16px; height: 16px;"></img>3、PageTransformer</h2><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">ViewPager有个方法叫做：</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">setPageTransformer(boolean reverseDrawingOrder, PageTransformer transformer) 用于设置ViewPager切换时的动画效果，并且google官方还给出了两个示例。</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">只需要在上述代码中调用setPageTransformer即可添加切换动画效果~~下面演示google的两个PageTransformer的代码，以及运行效果。</p><div style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><div><span style="color: rgb(85, 85, 85);"><span style="font-size: 15px;"><span style="font-family: 'microsoft yahei';"><strong>1、DepthPageTransformer</strong></span></span></span></div><div><span style="color: rgb(85, 85, 85);"><span style="font-size: 15px;"><span style="font-family: 'microsoft yahei';"><b><br/></b></span></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>- public class DepthPageTransformer implements ViewPager.PageTransformer {</div><div>-     private static final float MIN_SCALE = 0.75f;</div><div>-<br/></div><div>-     public void transformPage(View view, float position) {</div><div>-         int pageWidth = view.getWidth();</div><div>-<br/></div><div>-         if (position &lt; -1) { // [-Infinity,-1)<br/></div><div>-             // This page is way off-screen to the left.<br/></div><div>-             view.setAlpha(0);</div><div>-<br/></div><div>-         } else if (position &lt;= 0) { // [-1,0]<br/></div><div>-             // Use the default slide transition when moving to the left page<br/></div><div>-             view.setAlpha(1);</div><div>-             view.setTranslationX(0);</div><div>-             view.setScaleX(1);</div><div>-             view.setScaleY(1);</div><div>-<br/></div><div>-         } else if (position &lt;= 1) { // (0,1]<br/></div><div>-             // Fade the page out.<br/></div><div>-             view.setAlpha(1 - position);</div><div>-<br/></div><div>-             // Counteract the default slide transition<br/></div><div>-             view.setTranslationX(pageWidth * -position);</div><div>-<br/></div><div>-             // Scale the page down (between MIN_SCALE and 1)<br/></div><div>-             float scaleFactor = MIN_SCALE</div><div>-                     + (1 - MIN_SCALE) * (1 - Math.abs(position));</div><div>-             view.setScaleX(scaleFactor);</div><div>-             view.setScaleY(scaleFactor);</div><div>-<br/></div><div>-         } else { // (1,+Infinity]<br/></div><div>-             // This page is way off-screen to the right.<br/></div><div>-             view.setAlpha(0);</div><div>-         }</div><div>-     }</div><div>- }</div></div><div><span style="color: rgb(85, 85, 85);"><span style="font-size: 15px;"><span style="font-family: 'microsoft yahei';"><b><br/></b></span></span></span></div><div><span style="color: rgb(85, 85, 85);"><span style="font-size: 15px;"><span style="font-family: 'microsoft yahei';"><b>调用：</b></span></span></span></div><div><span style="color: rgb(85, 85, 85);"><span style="font-size: 15px;"><span style="font-family: 'microsoft yahei';"><b><br/></b></span></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>mViewPager.setPageTransformer(true, new DepthPageTransformer());</div></div><div><span style="color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none; background-color: rgb(255, 255, 255);">效果：</span></div><div><img src="Android 实现个性的ViewPager切换动画 实战PageTransformer（_files/20141028231742399.gif" type="image/gif"/></div><div><strong style="color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;">2、ZoomOutPageTransformer</strong></div><div><b><span style="font-size: 15px;"><span style="font-family: 'microsoft yahei';"><span style="color: rgb(85, 85, 85);"><br/></span></span></span></b></div><div><b><span style="font-size: 15px;"><span style="font-family: 'microsoft yahei';"><span style="color: rgb(85, 85, 85);"><br/></span></span></span></b></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>- package com.zhy.view;</div><div>-<br/></div><div>- import android.annotation.SuppressLint;</div><div>- import android.support.v4.view.ViewPager;</div><div>- import android.util.Log;</div><div>- import android.view.View;</div><div>-<br/></div><div>- public class ZoomOutPageTransformer implements ViewPager.PageTransformer</div><div>- {</div><div>-     private static final float MIN_SCALE = 0.85f;</div><div>-     private static final float MIN_ALPHA = 0.5f;</div><div>-<br/></div><div>-     @SuppressLint(&quot;NewApi&quot;)</div><div>-     public void transformPage(View view, float position)</div><div>-     {</div><div>-         int pageWidth = view.getWidth();</div><div>-         int pageHeight = view.getHeight();</div><div>-<br/></div><div>-         Log.e(&quot;TAG&quot;, view + &quot; , &quot; + position + &quot;&quot;);</div><div>-<br/></div><div>-         if (position &lt; -1)</div><div>-         { // [-Infinity,-1)<br/></div><div>-             // This page is way off-screen to the left.<br/></div><div>-             view.setAlpha(0);</div><div>-<br/></div><div>-         } else if (position &lt;= 1) //a页滑动至b页 ； a页从 0.0 -1 ；b页从1 ~ 0.0<br/></div><div>-         { // [-1,1]<br/></div><div>-             // Modify the default slide transition to shrink the page as well<br/></div><div>-             float scaleFactor = Math.max(MIN_SCALE, 1 - Math.abs(position));</div><div>-             float vertMargin = pageHeight * (1 - scaleFactor) / 2;</div><div>-             float horzMargin = pageWidth * (1 - scaleFactor) / 2;</div><div>-             if (position &lt; 0)</div><div>-             {</div><div>-                 view.setTranslationX(horzMargin - vertMargin / 2);</div><div>-             } else<br/></div><div>-             {</div><div>-                 view.setTranslationX(-horzMargin + vertMargin / 2);</div><div>-             }</div><div>-<br/></div><div>-             // Scale the page down (between MIN_SCALE and 1)<br/></div><div>-             view.setScaleX(scaleFactor);</div><div>-             view.setScaleY(scaleFactor);</div><div>-<br/></div><div>-             // Fade the page relative to its size.<br/></div><div>-             view.setAlpha(MIN_ALPHA + (scaleFactor - MIN_SCALE)</div><div>-                     / (1 - MIN_SCALE) * (1 - MIN_ALPHA));</div><div>-<br/></div><div>-         } else<br/></div><div>-         { // (1,+Infinity]<br/></div><div>-             // This page is way off-screen to the right.<br/></div><div>-             view.setAlpha(0);</div><div>-         }</div><div>-     }</div><div>- }</div></div><div><img src="Android 实现个性的ViewPager切换动画 实战PageTransformer（_files/20141028231715785.gif" type="image/gif"/></div><div><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">效果图都是google官网上的，我们的测试图会在兼容3.0以下贴出来，不然就重复了~~</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">为ViewPager添加切换就一行代码是不是很happy，可惜是不兼容3.0以下的版本的，该方法的注释上写到：</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">setting a PageTransformer prior to Android 3.0 (API 11) will have no effect 在3.0之前的版本设置此方法是没有效果的，那么下面我们就看如何让其兼容3.0以下版本。</p><h1 style="font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; background-color: rgb(255, 255, 255);"><img src="http://blog.n8n.cn/wp-content/plugins/kindeditor-for-wordpress/themes/common/anchor.gif" style="border: 1px dashed rgb(102, 102, 102); width: 16px; height: 16px;"></img>3、版本的向下兼容</h1><h2 style="font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; background-color: rgb(255, 255, 255);"><img src="http://blog.n8n.cn/wp-content/plugins/kindeditor-for-wordpress/themes/common/anchor.gif" style="border: 1px dashed rgb(102, 102, 102); width: 16px; height: 16px;"></img>1、不兼容的原因</h2><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">首先看下为什么不兼容，3.0以下呢？</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">看上面的两个示例代码，代码中View的动画使用的是属性动画，而属性动画是3.0才推出的，那么这么写肯定是不兼容3.0以下了~</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">那么我们首先引入nineoldandroids，让动画先能在3.0以下跑再说：</p><div style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><div><span style="color: rgb(85, 85, 85);"><span style="font-size: 15px;"><span style="font-family: 'microsoft yahei';">修改DepthPageTransformer</span></span></span></div><div><span style="color: rgb(85, 85, 85);"><span style="font-size: 15px;"><span style="font-family: 'microsoft yahei';"><br/></span></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>- package com.zhy.view;</div><div>-<br/></div><div>- import com.nineoldandroids.view.ViewHelper;</div><div>-<br/></div><div>- import android.annotation.SuppressLint;</div><div>- import android.support.v4.view.ViewPager;</div><div>- import android.view.View;</div><div>-<br/></div><div>- public class DepthPageTransformer implements ViewPager.PageTransformer</div><div>- {</div><div>-     private static final float MIN_SCALE = 0.75f;</div><div>-<br/></div><div>-     public void transformPage(View view, float position)</div><div>-     {</div><div>-         int pageWidth = view.getWidth();</div><div>-<br/></div><div>-         if (position &lt; -1)</div><div>-         { // [-Infinity,-1)<br/></div><div>-             // This page is way off-screen to the left.<br/></div><div>-             // view.setAlpha(0);<br/></div><div>-             ViewHelper.setAlpha(view, 0);</div><div>-         } else if (position &lt;= 0)// a页滑动至b页 ； a页从 0.0 -1 ；b页从1 ~ 0.0<br/></div><div>-         { // [-1,0]<br/></div><div>-             // Use the default slide transition when moving to the left page<br/></div><div>-             // view.setAlpha(1);<br/></div><div>-             ViewHelper.setAlpha(view, 1);</div><div>-             // view.setTranslationX(0);<br/></div><div>-             ViewHelper.setTranslationX(view, 0);</div><div>-             // view.setScaleX(1);<br/></div><div>-             ViewHelper.setScaleX(view, 1);</div><div>-             // view.setScaleY(1);<br/></div><div>-             ViewHelper.setScaleY(view, 1);</div><div>-<br/></div><div>-         } else if (position &lt;= 1)</div><div>-         { // (0,1]<br/></div><div>-             // Fade the page out.<br/></div><div>-             // view.setAlpha(1 - position);<br/></div><div>-             ViewHelper.setAlpha(view, 1 - position);</div><div>-<br/></div><div>-             // Counteract the default slide transition<br/></div><div>-             // view.setTranslationX(pageWidth * -position);<br/></div><div>-             ViewHelper.setTranslationX(view, pageWidth * -position);</div><div>-<br/></div><div>-             // Scale the page down (between MIN_SCALE and 1)<br/></div><div>-             float scaleFactor = MIN_SCALE + (1 - MIN_SCALE) * (1 - position);</div><div>-             // view.setScaleX(scaleFactor);<br/></div><div>-             ViewHelper.setScaleX(view, scaleFactor);</div><div>-             // view.setScaleY(1);<br/></div><div>-             ViewHelper.setScaleY(view, scaleFactor);</div><div>-<br/></div><div>-         } else<br/></div><div>-         { // (1,+Infinity]<br/></div><div>-             // This page is way off-screen to the right.<br/></div><div>-             // view.setAlpha(0);<br/></div><div>-             ViewHelper.setAlpha(view, 1);</div><div>-         }</div><div>-     }</div><div>- }</div></div><div><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">很简单，把所有属性动画换成ViewHelper去设置就好了。现在我们去3.0以下的机子上去运行，发现还是没有效果~~~</span><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">为什么呢？</p><div style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><div><span style="color: rgb(85, 85, 85);"><span style="font-size: 15px;"><span style="font-family: 'microsoft yahei';">我们再去看看setPageTransformer的源码：</span></span></span></div><div><span style="font-size: 15px;"><span style="font-family: 'microsoft yahei';"><span style="color: rgb(85, 85, 85);"><br/></span></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>- public void setPageTransformer(boolean reverseDrawingOrder, PageTransformer transformer) {</div><div>-        if (Build.VERSION.SDK_INT &gt;= 11) {</div><div>-            final boolean hasTransformer = transformer != null;</div><div>-            final boolean needsPopulate = hasTransformer != (mPageTransformer != null);</div><div>-            mPageTransformer = transformer;</div><div>-            setChildrenDrawingOrderEnabledCompat(hasTransformer);</div><div>-            if (hasTransformer) {</div><div>-                mDrawingOrder = reverseDrawingOrder ? DRAW_ORDER_REVERSE : DRAW_ORDER_FORWARD;</div><div>-            } else {</div><div>-                mDrawingOrder = DRAW_ORDER_DEFAULT;</div><div>-            }</div><div>-            if (needsPopulate) populate();</div><div>-        }</div><div>-    }</div></div><div><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">终于发现原因了，原来在此方法内部判断了如果是11以上的版本才让动画生效~~</span><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">那么，没办法了，如果想兼容，必须修改ViewPager的源码了~~</p><h2 style="font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; background-color: rgb(255, 255, 255);"><img src="http://blog.n8n.cn/wp-content/plugins/kindeditor-for-wordpress/themes/common/anchor.gif" style="border: 1px dashed rgb(102, 102, 102); width: 16px; height: 16px;"></img>2、完美向下兼容</h2><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">我们将ViewPager的源码拷贝一份至我们的项目中，修改名称为ViewPagerCompat；然后注释掉SDK版本判断那一句</p><div style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><div><span style="color: rgb(85, 85, 85);"><span style="font-size: 15px;"><span style="font-family: 'microsoft yahei';">public class ViewPagerCompat extends ViewGroup {</span></span></span></div><div><span style="color: rgb(85, 85, 85);"><span style="font-size: 15px;"><span style="font-family: 'microsoft yahei';"><br/></span></span></span></div><div><span style="color: rgb(85, 85, 85);"><span style="font-size: 15px;"><span style="font-family: 'microsoft yahei';"><br/></span></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>- public void setPageTransformer(boolean reverseDrawingOrder, ViewPager.PageTransformer transformer) {</div><div>- //        if (Build.VERSION.SDK_INT &gt;= 11)<br/></div><div>-         {</div><div>-             final boolean hasTransformer = transformer != null;</div><div>-             final boolean needsPopulate = hasTransformer != (mPageTransformer != null);</div><div>-             mPageTransformer = transformer;</div><div>-             setChildrenDrawingOrderEnabledCompat(hasTransformer);</div><div>-             if (hasTransformer) {</div><div>-                 mDrawingOrder = reverseDrawingOrder ? DRAW_ORDER_REVERSE : DRAW_ORDER_FORWARD;</div><div>-             } else {</div><div>-                 mDrawingOrder = DRAW_ORDER_DEFAULT;</div><div>-             }</div><div>-             if (needsPopulate) populate();</div><div>-         }</div><div>-     }</div></div><div><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">注意，所有的PageTransformer使用ViewPager.PageTransformer</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">然后我们把项目中的ViewPager改为ViewPagerCompat；记得修改布局文件，以及MainActivity中的ViewPager为ViewPagerCompat</p><div style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><div><span style="color: rgb(85, 85, 85);"><span style="font-size: 15px;"><span style="font-family: 'microsoft yahei';">我们在2.3.3的模拟器上测试下效果：</span></span></span></div><div><img src="Android 实现个性的ViewPager切换动画 实战PageTransformer（_files/20141028231840899.gif" type="image/gif"/></div><div><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">可以看到，我们的切换动画完美的运行在2.3.3的机器上~~so happy ~~没有ViewPager源码的童鞋不要紧，我会在文末的源码下载中加入ViewPager源码，让你可以尽情去测试~~</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">当然了，仅仅是兼容当然不能满足我们的好奇心，难道我们做到了兼容，还只能使用Google给的示例动画么~~我们强大的创新呢~~下面带领大家分析setPageTransformer方法，然后设计一个个性的动画切换效果</p></div><div><br/></div><div style="font-style: normal; font-variant: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><div><span style="color: rgb(85, 85, 85);"><span style="font-size: 26px;"><span style="font-family: 'microsoft yahei';"><b><img src="http://blog.n8n.cn/wp-content/plugins/kindeditor-for-wordpress/themes/common/anchor.gif" style="border: 1px dashed rgb(102, 102, 102); width: 16px; height: 16px;"></img>4、自定义PageTransformer实现个性切换动画</b></span></span></span></div><div><span style="color: rgb(85, 85, 85);"><span style="font-size: 26px;"><span style="font-family: 'microsoft yahei';"><b><br/></b></span></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div><b>- public interface PageTransformer {</b></div><div><b>-        /**</b></div><div><b>-         * Apply a property transformation to the given page.</b></div><div><b>-         *</b></div><div><b>-         * @param page Apply the transformation to this page</b></div><div><b>-         * @param position Position of page relative to the current front-and-center</b></div><div><b>-         *                 position of the pager. 0 is front and center. 1 is one full</b></div><div><b>-         *                 page position to the right, and -1 is one page position to the left.</b></div><div><b>-         */</b></div><div><b>-        public void transformPage(View page, float position);</b></div><div><b>-    }</b></div></div><div><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">可以看到该接口只有一个方法，第一个是我们的view，第二个是position~~</span><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">当我们滑动时：会打印出当然ViewPager中存活的每个View以及它们的position的变化~~注意是每一个，所以建议别只log position，不然你会觉得莫名其妙的输出~~</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">position的可能性的值有，其实从官方示例的注释就能看出：</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">[-Infinity,-1)  已经看不到了</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">(1,+Infinity] 已经看不到了</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);"> [-1,1] </p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">重点看[-1,1]这个区间 ， 其他两个的View都已经看不到了~~</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);"><br/>
假设现在ViewPager在A页现在滑出B页，则:</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">A页的position变化就是( 0, -1]</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">B页的position变化就是[ 1 , 0 ]</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">知道了我们滑动时position的变化~~那么就开始设计我们的个性的切换效果；</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">官方给的例子，有变化透明度、偏移量、缩放的，我们准备来个不一样的，我们变化角度，即rotation;</p><div style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><div><span style="color: rgb(85, 85, 85);"><span style="font-size: 15px;"><span style="font-family: 'microsoft yahei';">大概的效果是这样的：</span></span></span></div><div><img src="Android 实现个性的ViewPager切换动画 实战PageTransformer（_files/1414293422_1593.gif" type="image/gif"/></div><div><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">下面我们分析代码：</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">我们设置View的旋转中心为：</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">ViewHelper.setPivotX(view, view.getMeasuredWidth() * 0.5f);<br/>
ViewHelper.setPivotY(view, view.getMeasuredHeight());</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">依然是ViewPager在A页现在滑出B页</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">那么A页应当在滑动过程中0度到-20度的偏移，B页应当在滑动过程中+20度到0度的偏移</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">结合</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">A页的position变化就是( 0, -1]</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">B页的position变化就是[ 1 , 0 ]</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">那么旋转的角度即：mRot = (20 * position); A页 mRot :0 ,~ -20 ; B页 mRot :20 ~ 0  ;</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">瞬间觉得好简单：</p><div style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><div><span style="color: rgb(85, 85, 85);"><span style="font-size: 15px;"><span style="font-family: 'microsoft yahei';">完整代码：</span></span></span></div><div><span style="color: rgb(85, 85, 85);"><span style="font-size: 15px;"><span style="font-family: 'microsoft yahei';"><br/></span></span></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>- package com.zhy.view;</div><div>-<br/></div><div>- import com.nineoldandroids.view.ViewHelper;</div><div>-<br/></div><div>- import android.annotation.SuppressLint;</div><div>- import android.support.v4.view.ViewPager;</div><div>- import android.util.Log;</div><div>- import android.view.View;</div><div>-<br/></div><div>- public class RotateDownPageTransformer implements ViewPager.PageTransformer</div><div>- {</div><div>-<br/></div><div>-     private static final float ROT_MAX = 20.0f;</div><div>-     private float mRot;</div><div>-<br/></div><div>-<br/></div><div>-<br/></div><div>-     public void transformPage(View view, float position)</div><div>-     {</div><div>-<br/></div><div>-         Log.e(&quot;TAG&quot;, view + &quot; , &quot; + position + &quot;&quot;);</div><div>-<br/></div><div>-         if (position &lt; -1)</div><div>-         { // [-Infinity,-1)<br/></div><div>-             // This page is way off-screen to the left.<br/></div><div>-             ViewHelper.setRotation(view, 0);</div><div>-<br/></div><div>-         } else if (position &lt;= 1) // a页滑动至b页 ； a页从 0.0 ~ -1 ；b页从1 ~ 0.0<br/></div><div>-         { // [-1,1]<br/></div><div>-             // Modify the default slide transition to shrink the page as well<br/></div><div>-             if (position &lt; 0)</div><div>-             {</div><div>-<br/></div><div>-                 mRot = (ROT_MAX * position);</div><div>-                 ViewHelper.setPivotX(view, view.getMeasuredWidth() * 0.5f);</div><div>-                 ViewHelper.setPivotY(view, view.getMeasuredHeight());</div><div>-                 ViewHelper.setRotation(view, mRot);</div><div>-             } else<br/></div><div>-             {</div><div>-<br/></div><div>-                 mRot = (ROT_MAX * position);</div><div>-                 ViewHelper.setPivotX(view, view.getMeasuredWidth() * 0.5f);</div><div>-                 ViewHelper.setPivotY(view, view.getMeasuredHeight());</div><div>-                 ViewHelper.setRotation(view, mRot);</div><div>-             }</div><div>-<br/></div><div>-             // Scale the page down (between MIN_SCALE and 1)<br/></div><div>-<br/></div><div>-             // Fade the page relative to its size.<br/></div><div>-<br/></div><div>-         } else<br/></div><div>-         { // (1,+Infinity]<br/></div><div>-             // This page is way off-screen to the right.<br/></div><div>-             ViewHelper.setRotation(view, 0);</div><div>-         }</div><div>-     }</div><div>- }</div></div><div><br style="color: rgb(0, 0, 0); font-family: 'sans serif', tahoma, verdana, helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"/><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">你没看错，if else 里面代码是一样的，为了好理解特意没有合并到一起~~~</span><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);"> </p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">到此，我们从setPageTransformer使用，到修改ViewPager做到向下兼容，直至自己定义出个性的切换效果 都已经介绍完毕～～</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">大家可以发挥自己的创造力，做出各种神奇的动画效果，ok，就到这里！</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);">如果你喜欢自定义ViewPager来实现，请移步：<a href="http://blog.csdn.net/lmj623565791/article/details/38026503" target="_blank">Android 自定义 ViewPager 打造千变万化的图片切换效果</a></p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);"><br/></p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; font-size: 15px; background-color: rgb(255, 255, 255);"><br/></p><div style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(85, 85, 85); font-family: 'microsoft yahei'; background-color: rgb(255, 255, 255); font-size: 15px;"><div><a href="http://download.csdn.net/detail/lmj623565791/8093373" target="_blank"><span style="font-size: 24px; color: rgb(0, 153, 0);">源码点击下载</span></a></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></span>
</div></body></html> 