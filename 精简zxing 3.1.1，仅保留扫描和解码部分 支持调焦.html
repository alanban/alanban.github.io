<html>
<head>
  <title>精简zxing 3.1.1，仅保留扫描和解码部分 支持调焦</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303502 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="751"/>
<h1>精简zxing 3.1.1，仅保留扫描和解码部分 支持调焦</h1>

<div>
<span><div><p style="word-wrap: break-word; margin: 5px 0px; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);"><span style="color: rgb(102, 102, 102); font-family: 'Microsoft YaHei', Tahoma, Helvetica, SimSun, sans-serif; font-size: 14.4444446563721px;"><span style="font-family: Helvetica, arial, freesans, clean, sans-serif;"><span style="font-size: 16px;">代码的主要功能的实现使用了zxing 3.1.1的代码，并对其进行了精简，现在仅保存扫描和解码部分。</span></span></span></p><p style="word-wrap: break-word; margin: 5px 0px; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);"><span style="color: rgb(102, 102, 102); font-family: 'Microsoft YaHei', Tahoma, Helvetica, SimSun, sans-serif; font-size: 14.4444446563721px;"><span style="font-family: Helvetica, arial, freesans, clean, sans-serif;"><span style="font-size: 16px;">现在代码支持低版本的sdk，实现了二维码和一维码的扫描、从图库中的图片解析一维码和二维码，闪光灯开启、调焦。</span></span></span></p><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Helvetica, arial, freesans, clean, sans-serif; color: rgb(51, 51, 51); font-size: 14.4444446563721px; background-color: rgb(255, 255, 255);"><span style="font-size: 14px;"><span style="color: rgb(102, 102, 102);">支持<a href="http://lib.csdn.net/base/5" target="_blank">微信</a>式的扫描框</span></span></span><br style="color: rgb(0, 0, 0); font-family: 'sans serif', tahoma, verdana, helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"/><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Helvetica, arial, freesans, clean, sans-serif; color: rgb(51, 51, 51); font-size: 14.4444446563721px; background-color: rgb(255, 255, 255);"><span style="font-size: 14px;"><span style="color: rgb(102, 102, 102);">N多注释</span></span></span><br style="color: rgb(0, 0, 0); font-family: 'sans serif', tahoma, verdana, helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"/><br style="color: rgb(0, 0, 0); font-family: 'sans serif', tahoma, verdana, helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"/><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Helvetica, arial, freesans, clean, sans-serif; color: rgb(51, 51, 51); font-size: 14.4444446563721px; background-color: rgb(255, 255, 255);"><span style="font-size: 14px;"><span style="color: rgb(102, 102, 102);">本次精简和特性支持主要经过了以下几个步骤：</span></span></span><br style="color: rgb(0, 0, 0); font-family: 'sans serif', tahoma, verdana, helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"/><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Helvetica, arial, freesans, clean, sans-serif; color: rgb(51, 51, 51); font-size: 14.4444446563721px; background-color: rgb(255, 255, 255);"><span style="font-size: 14px;"><span style="color: rgb(102, 102, 102);">0、编译zxing3.1.1代码的core、<a href="http://lib.csdn.net/base/15" target="_blank">android</a>-core文件夹，具体是命令行窗口到文件夹路径后，运行 </span></span></span><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: 'Microsoft YaHei', Tahoma, Helvetica, SimSun, sans-serif; font-size: 14.4444446563721px; background-color: rgb(248, 248, 248);"><span style="font-family: Consolas;">mvn -DskipTests package （maven命令）编译</span></span><br style="color: rgb(0, 0, 0); font-family: 'sans serif', tahoma, verdana, helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"/><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Helvetica, arial, freesans, clean, sans-serif; color: rgb(51, 51, 51); font-size: 14.4444446563721px; background-color: rgb(255, 255, 255);"><span style="font-size: 14px;"><span style="color: rgb(102, 102, 102);">1、引入</span></span></span><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(102, 102, 102); font-family: 'Microsoft YaHei', Tahoma, Helvetica, SimSun, sans-serif; font-size: 14.4444446563721px; background-color: rgb(255, 255, 255);"><span style="font-family: Helvetica, arial, freesans, clean, sans-serif;"><span style="font-size: 16px;">zxing 3.1.1的代码，裁剪代码，做完裁剪后，可以运行，支持横屏扫描，并支持android 4.0系统以上的机子使用</span></span></span><br style="color: rgb(0, 0, 0); font-family: 'sans serif', tahoma, verdana, helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"/><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(102, 102, 102); font-family: 'Microsoft YaHei', Tahoma, Helvetica, SimSun, sans-serif; font-size: 14.4444446563721px; background-color: rgb(255, 255, 255);"><span style="font-family: Helvetica, arial, freesans, clean, sans-serif;"><span style="font-size: 16px;">2、修改代码支持竖屏扫描</span></span></span><br style="color: rgb(0, 0, 0); font-family: 'sans serif', tahoma, verdana, helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"/><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(102, 102, 102); font-family: 'Microsoft YaHei', Tahoma, Helvetica, SimSun, sans-serif; font-size: 14.4444446563721px; background-color: rgb(255, 255, 255);"><span style="font-family: Helvetica, arial, freesans, clean, sans-serif;"><span style="font-size: 16px;">3、把一些仅支持高版本的sdk的代码修改成兼容低版本的代码：如增加了runnable.<a href="http://lib.csdn.net/base/17" target="_blank">java</a>文件，兼容</span></span></span><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Helvetica, arial, freesans, clean, sans-serif; color: rgb(51, 51, 51); font-size: 14.4444446563721px; background-color: rgb(255, 255, 255);"><span style="color: rgb(102, 102, 102);">task.executeOnExecutor</span></span><br style="color: rgb(0, 0, 0); font-family: 'sans serif', tahoma, verdana, helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"/><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(102, 102, 102); font-family: 'Microsoft YaHei', Tahoma, Helvetica, SimSun, sans-serif; font-size: 14.4444446563721px; background-color: rgb(255, 255, 255);"><span style="font-family: Helvetica, arial, freesans, clean, sans-serif;"><span style="font-size: 16px;">4、完成微信扫描框</span></span></span><br style="color: rgb(0, 0, 0); font-family: 'sans serif', tahoma, verdana, helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"/><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(102, 102, 102); font-family: 'Microsoft YaHei', Tahoma, Helvetica, SimSun, sans-serif; font-size: 14.4444446563721px; background-color: rgb(255, 255, 255);"><span style="font-family: Helvetica, arial, freesans, clean, sans-serif;"><span style="font-size: 16px;">5、修改代码，支持从图片解码二维码（核心文件是</span></span></span><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Helvetica, arial, freesans, clean, sans-serif; color: rgb(51, 51, 51); font-size: 14.4444446563721px; background-color: rgb(255, 255, 255);"><span style="font-size: 14px;"><span style="color: rgb(102, 102, 102);">BitmapDecoder.java 和 BitmapLuminanceSource.java</span></span></span><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(102, 102, 102); font-family: 'Microsoft YaHei', Tahoma, Helvetica, SimSun, sans-serif; font-size: 14.4444446563721px; background-color: rgb(255, 255, 255);"><span style="font-family: Helvetica, arial, freesans, clean, sans-serif;"><span style="font-size: 16px;">），修改</span></span></span><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Helvetica, arial, freesans, clean, sans-serif; color: rgb(51, 51, 51); font-size: 14.4444446563721px; background-color: rgb(255, 255, 255);"><span style="font-size: 14px;"><span style="color: rgb(102, 102, 102);">CameraManager.java，支持变焦</span></span></span><br style="color: rgb(0, 0, 0); font-family: 'sans serif', tahoma, verdana, helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"/><span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Helvetica, arial, freesans, clean, sans-serif; color: rgb(51, 51, 51); font-size: 14.4444446563721px; background-color: rgb(255, 255, 255);"><span style="font-size: 14px;"><span style="color: rgb(102, 102, 102);"><br/></span></span></span><br style="color: rgb(0, 0, 0); font-family: 'sans serif', tahoma, verdana, helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"/><p style="word-wrap: break-word; margin: 5px 0px; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);"><span style="color: rgb(102, 102, 102); font-family: 'Microsoft YaHei', Tahoma, Helvetica, SimSun, sans-serif; font-size: 14.4444446563721px;"><span style="font-family: Helvetica, arial, freesans, clean, sans-serif;"><span style="font-size: 16px;">有个小问题，希望大家帮解决一下，代码在魅族M9（SDK 9）环境下，还是会出现横屏的现象，还感觉有点变形</span></span></span></p><p style="word-wrap: break-word; margin: 5px 0px; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);"><span style="color: rgb(102, 102, 102); font-family: 'Microsoft YaHei', Tahoma, Helvetica, SimSun, sans-serif; font-size: 14.4444446563721px;"><span style="font-family: Helvetica, arial, freesans, clean, sans-serif;"><span style="font-size: 16px;"><br/></span></span></span></p><div style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><div><span style="font-size: 14px;"><span style="font-family: Helvetica, arial, freesans, clean, sans-serif; color: rgb(102, 102, 102);">代码结构如下：</span></span></div><div><img src="精简zxing 3.1.1，仅保留扫描和解码部分 支持调焦_files/20140530000406828.png" type="image/png"/></div><div><span style="color: rgb(102, 102, 102); font-family: Helvetica, arial, freesans, clean, sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none; background-color: rgb(255, 255, 255);">运行画面：</span></div><div><img src="精简zxing 3.1.1，仅保留扫描和解码部分 支持调焦_files/20140530000310593.jpg" type="image/jpeg"/></div><div><p style="word-wrap: break-word; margin: 5px 0px; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);"><span style="font-family: Helvetica, arial, freesans, clean, sans-serif; color: rgb(102, 102, 102);">代码托管在github</span></p><p style="word-wrap: break-word; margin: 5px 0px; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);"><span style="font-family: Helvetica, arial, freesans, clean, sans-serif; color: rgb(102, 102, 102);">https://github.com/mooncafes/BarcodeScanner<br/></span></p><p style="word-wrap: break-word; margin: 5px 0px; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);"><span style="font-family: Helvetica, arial, freesans, clean, sans-serif; color: rgb(102, 102, 102);">转载注明：</span></p><p style="word-wrap: break-word; margin: 5px 0px; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);"><span style="font-family: Helvetica, arial, freesans, clean, sans-serif; color: rgb(102, 102, 102);">http://blog.csdn.net/huang86411/article/details/27592831<br/></span></p><div style="word-wrap: break-word; margin: 5px 0px; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; background-color: rgb(255, 255, 255); font-size: 14px;"><div><span style="font-family: Helvetica, arial, freesans, clean, sans-serif; color: rgb(102, 102, 102);">http://www.eoeandroid.com/forum.php?mod=viewthread&amp;tid=494931&amp;page=1&amp;extra=#pid4065518</span></div></div></div></div></div></span>
</div></body></html> 