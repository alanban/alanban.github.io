<html>
<head>
  <title>慎用InputStream的read()方法</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303502 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="636"/>
<h1>慎用InputStream的read()方法</h1>

<div>
<span><div><p style="word-wrap: break-word; margin: 5px 0px; font-family: Calibri; font-size: 10.5pt;">  InputStream 此抽象类是表示字节输入流的所有类的超类。</p><p style="word-wrap: break-word; margin: 5px 0px; font-size: 10.5pt;"><span style="font-family: Calibri;">          </span><span style="font-family: SimSun;">我们从输入流中读取数据最常用的方法基本上就是如下</span> <span style="font-family: Calibri;">3</span> <span style="font-family: SimSun;">个</span> <span style="font-family: Calibri;">read()</span> <span style="font-family: SimSun;">方法了：</span></p><p style="word-wrap: break-word; margin: 5px 0px; font-size: 10.5pt;"><span style="font-family: Calibri;">         1</span> <span style="font-family: SimSun;">、</span> <span style="font-weight: bold; font-family: Calibri;">read</span> <span style="font-family: Calibri;">()</span> <span style="font-family: SimSun;">方法，这个方法</span> <span style="font-family: Calibri;">从输入流中读取数据的下一个字节。返回 0 </span><span style="font-family: SimSun;">到</span> <span style="font-family: Calibri;">255 </span><span style="font-family: SimSun;">范围内的</span> <span style="font-family: Calibri;">int </span><span style="font-family: SimSun;">字节值。如果因为已经到达流末尾而没有可用的字节，则返回值</span> <span style="font-family: Calibri;">-1</span> <span style="font-family: SimSun;">。</span></p><p style="word-wrap: break-word; margin: 5px 0px; font-size: 10.5pt;"><span style="font-family: Calibri;">         2</span> <span style="font-family: SimSun;">、</span> <span style="font-weight: bold; font-family: Calibri;">read</span> <span style="font-family: Calibri;">(byte[] b,int off,int len)</span> <span style="font-family: SimSun;">方法，</span> <span style="font-family: Calibri;">将输入流中最多 len </span><span style="font-family: SimSun;">个数据字节读入</span> <span style="font-family: Calibri;">byte </span><span style="font-family: SimSun;">数组。尝试读取</span> <span style="font-family: Calibri;">len </span><span style="font-family: SimSun;">个字节，但读取的字节也可能小于该值。以整数形式返回实际读取的字节数。</span></p><p style="word-wrap: break-word; margin: 5px 0px; font-size: 10.5pt;"><span style="font-family: Calibri;">         3</span> <span style="font-family: SimSun;">、</span> <span style="font-weight: bold; font-family: Calibri;">read</span> <span style="font-family: Calibri;">(byte[] b)</span> <span style="font-family: SimSun;">方法，</span> <span style="font-family: Calibri;">从输入流中读取一定数量的字节，并将其存储在缓冲区数组 b </span><span style="font-family: SimSun;">中。以整数形式返回实际读取的字节数。</span></p><p style="word-wrap: break-word; margin: 5px 0px; font-size: 10.5pt;"><span style="font-family: Calibri;">         </span><span style="font-family: SimSun;">第一个方法典型的确定就是处理效率低，不是某些特殊情况，很少使用它，下面说说第</span> <span style="font-family: Calibri;">2</span> <span style="font-family: SimSun;">个方法跟第</span> <span style="font-family: Calibri;">3</span> <span style="font-family: SimSun;">个方法，第</span> <span style="font-family: Calibri;">3</span> <span style="font-family: SimSun;">个方法的本本质其实就是第</span> <span style="font-family: Calibri;">2</span> <span style="font-family: SimSun;">个方法的特殊情况，</span> <span style="font-family: Calibri;">效果等同于：</span></p><p style="word-wrap: break-word; margin: 5px 0px; font-family: Calibri; font-size: 10.5pt;">          read(b, 0, b.length)</p><p style="word-wrap: break-word; margin: 5px 0px; font-family: SimSun; font-size: 10.5pt;">所以这里把他们放着一起讨论。</p><p style="word-wrap: break-word; margin: 5px 0px; font-size: 10.5pt;"><span style="font-family: Calibri;">         </span><span style="font-family: SimSun;">从第</span> <span style="font-family: Calibri;">2</span> <span style="font-family: SimSun;">个方法的</span> <span style="font-family: Calibri;">API</span> <span style="font-family: SimSun;">文档说明来看：“</span> <span style="font-family: Calibri;">将输入流中最多 len </span><span style="font-family: SimSun;">个数据字节读入</span> <span style="font-family: Calibri;">byte </span><span style="font-family: SimSun;">数组。尝试读取</span> <span style="font-family: Calibri;">len </span><span style="font-family: SimSun;">个字节，但读取的字节也可能小于该值。以整数形式返回实际读取的字节数。”，最多读取</span> <span style="font-family: Calibri;">len</span> <span style="font-family: SimSun;">个字节，这究竟是何意？</span><span style="font-family: Calibri;">API</span> <span style="font-family: SimSun;">文档并没有详细说明。是不是就意味着有可能（注意这里是有可能而不是一定，）读取不到</span> <span style="font-family: Calibri;">len</span> <span style="font-family: SimSun;">个字节呢？答案是“是的”。虽然造成这种情况的原因是什么个人并不知道，但是我们可以通过例子来发现这种情况，下面是源代码（由于只是简单的示例，所以代码也就随便写了）：</span></p><p style="word-wrap: break-word; margin: 5px 0px; font-size: 10.5pt;"> </p><p style="word-wrap: break-word; margin: 5px 0px; font-size: 10.5pt;"><span style="font-family: Calibri;">ServerSocket</span> <span style="font-family: SimSun;">端：</span></p><p style="word-wrap: break-word; margin: 5px 0px; font-size: 10.5pt;"> </p><div style="word-wrap: break-word; font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; margin-left: 9px; padding: 1px;"><div style="word-wrap: break-word;"><div style="word-wrap: break-word; padding: 3px; margin: 0px; font-weight: bold;">Java代码  <a><img src="慎用InputStream的read()方法_files/Image.png" type="image/png" alt="收藏代码" style="border: 0px;"/></a></div></div><ol style="font-size: 1em; color: rgb(43, 145, 175); background-color: rgb(255, 255, 255);"><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(127, 0, 85); font-weight: bold;">package</span> myspider;  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(127, 0, 85); font-weight: bold;">import</span> java.io.File;  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(127, 0, 85); font-weight: bold;">import</span> java.io.FileOutputStream;  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(127, 0, 85); font-weight: bold;">import</span> java.io.IOException;  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(127, 0, 85); font-weight: bold;">import</span> java.io.InputStream;  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(127, 0, 85); font-weight: bold;">import</span> java.net.ServerSocket;  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(127, 0, 85); font-weight: bold;">import</span> java.net.Socket;  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(0, 130, 0);">/**</span> </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(0, 130, 0);"> *</span> </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(0, 130, 0);"> * @author mark</span> </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(0, 130, 0);"> */</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(127, 0, 85); font-weight: bold;">public</span> <span style="color: rgb(127, 0, 85); font-weight: bold;">class</span> MyServerSocket {  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">    <span style="color: rgb(127, 0, 85); font-weight: bold;">public</span> <span style="color: rgb(127, 0, 85); font-weight: bold;">static</span> <span style="color: rgb(127, 0, 85); font-weight: bold;">void</span> main(String[] args) <span style="color: rgb(127, 0, 85); font-weight: bold;">throws</span> IOException {  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">        ServerSocket ss = <span style="color: rgb(127, 0, 85); font-weight: bold;">new</span> ServerSocket(<span style="color: rgb(192, 0, 0);">8888</span>);  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">        System.out.println(<span style="color: blue;">&quot;runing&quot;</span>);  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">        <span style="color: rgb(127, 0, 85); font-weight: bold;">while</span> (<span style="color: rgb(127, 0, 85); font-weight: bold;">true</span>) {  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">            <span style="color: rgb(127, 0, 85); font-weight: bold;">byte</span>[] b = <span style="color: rgb(127, 0, 85); font-weight: bold;">new</span> <span style="color: rgb(127, 0, 85); font-weight: bold;">byte</span>[<span style="color: rgb(192, 0, 0);">22480</span>];  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">            <span style="color: rgb(127, 0, 85); font-weight: bold;">int</span> readBytes = <span style="color: rgb(192, 0, 0);">0</span>;  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">            Socket s = ss.accept();  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">            InputStream is = s.getInputStream();  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">            <span style="color: rgb(127, 0, 85); font-weight: bold;">while</span> (readBytes &lt; <span style="color: rgb(192, 0, 0);">22480</span>) {  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">                <span style="color: rgb(127, 0, 85); font-weight: bold;">int</span> read = is.read(b, readBytes, <span style="color: rgb(192, 0, 0);">22480</span> - readBytes);  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">                System.out.println(read);  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">                <span style="color: rgb(127, 0, 85); font-weight: bold;">if</span> (read == -<span style="color: rgb(192, 0, 0);">1</span>) {  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">                    <span style="color: rgb(127, 0, 85); font-weight: bold;">break</span>;  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">                }  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">                readBytes += read;  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">            }  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">            File f = <span style="color: rgb(127, 0, 85); font-weight: bold;">new</span> File(<span style="color: blue;">&quot;F:\\project\\bocln_nacec\\xml\\ey.xml&quot;</span>);  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">            <span style="color: rgb(127, 0, 85); font-weight: bold;">if</span> (!f.exists()) {  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">                f.createNewFile();  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">                System.out.println(<span style="color: blue;">&quot;creat &quot;</span> + f.toString());  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">            }  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">            FileOutputStream fos = <span style="color: rgb(127, 0, 85); font-weight: bold;">new</span> FileOutputStream(f);  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">            fos.write(b, <span style="color: rgb(192, 0, 0);">0</span>, readBytes);  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">            fos.flush();  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">            fos.close();  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">            System.out.println(<span style="color: blue;">&quot;complete&quot;</span>);  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">            is.close();  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">            s.close();  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">        }  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">    }  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">}  </span></li></ol></div><p style="word-wrap: break-word; margin: 5px 0px;"> </p><p style="word-wrap: break-word; margin: 5px 0px;"><span style="font-family: Calibri;">Socket</span> <span style="font-family: SimSun;">端：</span></p><p style="word-wrap: break-word; margin: 5px 0px;"> </p><div style="word-wrap: break-word; font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; margin-left: 9px; padding: 1px;"><div style="word-wrap: break-word;"><div style="word-wrap: break-word; padding: 3px; margin: 0px; font-weight: bold;">Java代码  <a><img src="慎用InputStream的read()方法_files/Image [1].png" type="image/png" alt="收藏代码" style="border: 0px;"/></a></div></div><ol style="font-size: 1em; color: rgb(43, 145, 175); background-color: rgb(255, 255, 255);"><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(127, 0, 85); font-weight: bold;">package</span> myspider;  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(127, 0, 85); font-weight: bold;">import</span> java.io.File;  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(127, 0, 85); font-weight: bold;">import</span> java.io.FileInputStream;  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(127, 0, 85); font-weight: bold;">import</span> java.io.IOException;  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(127, 0, 85); font-weight: bold;">import</span> java.io.InputStream;  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(127, 0, 85); font-weight: bold;">import</span> java.io.OutputStream;  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(127, 0, 85); font-weight: bold;">import</span> java.net.Socket;  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(127, 0, 85); font-weight: bold;">import</span> java.net.UnknownHostException;  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(0, 130, 0);">/**</span> </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(0, 130, 0);"> *</span> </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(0, 130, 0);"> * @author mark</span> </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(0, 130, 0);"> */</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(127, 0, 85); font-weight: bold;">public</span> <span style="color: rgb(127, 0, 85); font-weight: bold;">class</span> MySocket {  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">    <span style="color: rgb(127, 0, 85); font-weight: bold;">public</span> <span style="color: rgb(127, 0, 85); font-weight: bold;">static</span> <span style="color: rgb(127, 0, 85); font-weight: bold;">void</span> main(String[] args) <span style="color: rgb(127, 0, 85); font-weight: bold;">throws</span> UnknownHostException, IOException {  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">        Socket s = <span style="color: rgb(127, 0, 85); font-weight: bold;">new</span> Socket(<span style="color: blue;">&quot;127.0.0.1&quot;</span>, <span style="color: rgb(192, 0, 0);">8888</span>);  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">        OutputStream os = s.getOutputStream();  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">        File f = <span style="color: rgb(127, 0, 85); font-weight: bold;">new</span> File(<span style="color: blue;">&quot;F:\\project\\bocln_nacec\\xml\\ye.xml&quot;</span>);  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">        InputStream is = <span style="color: rgb(127, 0, 85); font-weight: bold;">new</span> FileInputStream(f);  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">        <span style="color: rgb(127, 0, 85); font-weight: bold;">byte</span>[] b = <span style="color: rgb(127, 0, 85); font-weight: bold;">new</span> <span style="color: rgb(127, 0, 85); font-weight: bold;">byte</span>[<span style="color: rgb(192, 0, 0);">22480</span>];  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">        <span style="color: rgb(127, 0, 85); font-weight: bold;">int</span> i = is.read(b);  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">        is.close();  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">        os.write(b, <span style="color: rgb(192, 0, 0);">0</span>, i);  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">        os.flush();  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">        os.close();  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">        s.close();  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">    }  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">}  </span></li></ol></div><p style="word-wrap: break-word; margin: 5px 0px;"> </p><p style="word-wrap: break-word; margin: 5px 0px;"> </p><p style="word-wrap: break-word; margin: 5px 0px; font-size: 10.5pt;"><span style="font-family: SimSun;">先运行</span> <span style="font-family: Calibri;">MyServerSocket </span><span style="font-family: SimSun;">，让后多次运行</span> <span style="font-family: Calibri;">MySocket</span> <span style="font-family: SimSun;">，这是控制台的输出结果（</span> <span style="font-family: Calibri;">ye.xml</span> <span style="font-family: SimSun;">文件长度为</span> <span style="font-family: Calibri;">20389</span> <span style="font-family: SimSun;">）：</span></p><p style="word-wrap: break-word; margin: 5px 0px; font-size: 10.5pt;"> </p><div style="word-wrap: break-word; font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; margin-left: 9px; padding: 1px;"><div style="word-wrap: break-word;"><div style="word-wrap: break-word; padding: 3px; margin: 0px; font-weight: bold;">Java代码  <a><img src="慎用InputStream的read()方法_files/Image [2].png" type="image/png" alt="收藏代码" style="border: 0px;"/></a></div></div><ol style="font-size: 1em; color: rgb(43, 145, 175); background-color: rgb(255, 255, 255);"><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">runing  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">creat F:\project\bocln_nacec\xml\ey.xml  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">8760</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">11629</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">3760</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">620</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">16009</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">8760</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">11629</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">8760</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">11629</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">8760</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">11629</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(192, 0, 0);">20389</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">-<span style="color: rgb(192, 0, 0);">1</span>  </span></li><li style="font-size: 1em; background-color: rgb(250, 250, 250);"><span style="color: black;">complete  </span></li></ol></div><p style="word-wrap: break-word; margin: 5px 0px;"> </p><p style="word-wrap: break-word; margin: 5px 0px;"> </p><p style="word-wrap: break-word; margin: 5px 0px; font-size: 10.5pt;"><span style="font-family: Calibri;">         </span><span style="font-family: SimSun;">通过观察发现，在大多数情况下，我们能够用</span> <span style="font-family: Calibri;">is.read(b, readBytes, 22480 - readBytes)</span> <span style="font-family: SimSun;">一次性就读完整个文件，但是还是有极少数情况，我们需要两次(如36、37两行)甚至两次以上（如58、59、60）调用</span> <span style="font-family: Calibri;">is.read(b, readBytes, 22480 - readBytes)</span> <span style="font-family: SimSun;">方法才能把整个文件读取完。这里由于文件最长只有</span> <span style="font-family: Calibri;">20389</span> <span style="font-family: SimSun;">，所以我们能读到的最大字节数也就是</span> <span style="font-family: Calibri;">20389</span> <span style="font-family: SimSun;">而不会是</span> <span style="font-family: Calibri;">22480</span> <span style="font-family: SimSun;">了。</span></p><p style="word-wrap: break-word; margin: 5px 0px; font-size: 10.5pt;"><span style="font-family: Calibri;">         </span><span style="font-family: SimSun;">那么我们怎样写代码才能保证在数据流没有到达末尾的情况下读取到自己想要的长度的字节数据呢？我们可以这样写：</span> <span style="font-family: Calibri;">  </span></p><p style="word-wrap: break-word; margin: 5px 0px;"> </p><div style="word-wrap: break-word; font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; margin-left: 9px; padding: 1px;"><div style="word-wrap: break-word;"><div style="word-wrap: break-word; padding: 3px; margin: 0px; font-weight: bold;">Java代码  <a><img src="慎用InputStream的read()方法_files/Image [3].png" type="image/png" alt="收藏代码" style="border: 0px;"/></a></div></div><ol style="font-size: 1em; color: rgb(43, 145, 175); background-color: rgb(255, 255, 255);"><li style="color: rgb(43, 145, 175); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 1em; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(127, 0, 85); font-weight: bold;">int</span> readBytes=<span style="color: rgb(192, 0, 0);">0</span>;  </span></li><li style="color: rgb(43, 145, 175); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 1em; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><span style="color: black;">  </span></li><li style="color: rgb(43, 145, 175); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 1em; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><span style="color: black;">Byte[] b=<span style="color: rgb(127, 0, 85); font-weight: bold;">new</span> <span style="color: rgb(127, 0, 85); font-weight: bold;">byte</span>[<span style="color: rgb(192, 0, 0);">1024</span>]<span style="color: rgb(0, 130, 0);">//1024可改成任何需要的值</span>  </span></li><li style="color: rgb(43, 145, 175); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 1em; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><span style="color: black;">  </span></li><li style="color: rgb(43, 145, 175); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 1em; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(127, 0, 85); font-weight: bold;">int</span> len=b.length;  </span></li><li style="color: rgb(43, 145, 175); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 1em; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><span style="color: black;">  </span></li><li style="color: rgb(43, 145, 175); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 1em; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span style="color: rgb(127, 0, 85); font-weight: bold;">while</span> (readBytes &lt; len) {  </span></li><li style="color: rgb(43, 145, 175); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 1em; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><span style="color: black;">  </span></li><li style="color: rgb(43, 145, 175); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 1em; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><span style="color: black;">                <span style="color: rgb(127, 0, 85); font-weight: bold;">int</span> read = is.read(b, readBytes, len - readBytes);  </span></li><li style="color: rgb(43, 145, 175); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 1em; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><span style="color: black;">  </span></li><li style="color: rgb(43, 145, 175); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 1em; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><span style="color: black;">               <span style="color: rgb(0, 130, 0);">//判断是不是读到了数据流的末尾 ，防止出现死循环。</span>  </span></li><li style="color: rgb(43, 145, 175); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 1em; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><span style="color: black;">  </span></li><li style="color: rgb(43, 145, 175); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 1em; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><span style="color: black;">                <span style="color: rgb(127, 0, 85); font-weight: bold;">if</span> (read == -<span style="color: rgb(192, 0, 0);">1</span>) {  </span></li><li style="color: rgb(43, 145, 175); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 1em; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><span style="color: black;">  </span></li><li style="color: rgb(43, 145, 175); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 1em; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><span style="color: black;">                    <span style="color: rgb(127, 0, 85); font-weight: bold;">break</span>;  </span></li><li style="color: rgb(43, 145, 175); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 1em; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><span style="color: black;">  </span></li><li style="color: rgb(43, 145, 175); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 1em; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><span style="color: black;">                }  </span></li><li style="color: rgb(43, 145, 175); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 1em; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><span style="color: black;">  </span></li><li style="color: rgb(43, 145, 175); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 1em; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><span style="color: black;">                readBytes += read;  </span></li><li style="color: rgb(43, 145, 175); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 1em; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><span style="color: black;">  </span></li><li style="color: rgb(43, 145, 175); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 1em; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><span style="color: black;">            }  </span><br/></li></ol></div></div></span>
</div></body></html> 