<html>
<head>
  <title>sqlite 取日期的方法：年，季度，月，当月第几周</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303502 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="720"/>
<h1>sqlite 取日期的方法：年，季度，月，当月第几周</h1>

<div>
<span><div><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);">数据库为 sqlite3<br/>
表结构为 tblTask(ID int,TaskName varchar(20),ActionDate datetime)<br/>
问：sqlite 通过ActionDate 取季度 的 sql怎么写？<br/>
我这里暂时只知道几个例子：<br/>
取年份： select * from tblTask where strftime('%Y',ActionDate)='2011' --2011年<br/>
取月份： select * from tblTask where strftime('%m',ActionDate)='09'; -- 9月份<br/>
取季度？<br/>
取当月第几周?</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);"> </p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);">答案如下：</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);">select ActionDate<br/>
,round(strftime('%d',ActionDate)/7.0+ 0.495 ) as Week -- 当月第几周<br/>
,strftime('%m',ActionDate) AS Month -- 月份<br/>
,round(strftime('%m',ActionDate)/3.0 + 0.495) as Season --季度<br/>
,strftime('%Y',ActionDate) as Year -- 年份<br/>
from tblTask</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);">-----------------------------------------------------------------------------------------</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);">用strftime 函数<br/>
%d 日期, 01-31<br/>
%f 小数形式的秒，SS.SSS<br/>
%H 小时, 00-23<br/>
%j 算出某一天是该年的第几天，001-366<br/>
%m 月份，00-12<br/>
%M 分钟, 00-59<br/>
%s 从1970年1月1日到现在的秒数<br/>
%S 秒, 00-59<br/>
%w 星期, 0-6 (0是星期天)<br/>
%W 算出某一天属于该年的第几周, 01-53<br/>
%Y 年, YYYY<br/>
%% 百分号</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);"><br/></p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);">select * from tblWord where strftime(&quot;%d&quot;,updatedate)='26'  表示查询日期为26的数据。比如2012-9-26<br/></p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);"><span style="font-family: Verdana, sans-serif;">SELECT julianday('now') - julianday('1776-07-04'); 表示1776-7-4 距离今天有多少天</span><br/></p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);"><a href="http://www.sqlite.org/lang_datefunc.html">http://www.sqlite.org/lang_datefunc.html</a><br/></p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);"><br/></p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);">select cast(27.33 as int) -- 27<br/>
select cast(23.83 as int)  -- 24<br/>
select round(23.83,0)      -- 24<br/>
select round(23.8342367,4) -- 23.8342<br/>
select round(23.83,4)      --23.83</p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);"><br/></p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);">SELECT  <br/>
 (0&lt;=cast((julianday('now') - julianday(Updatedate)) as int)  and  7&gt;=cast((julianday('now') - julianday(Updatedate)) as int)) as Latest1Week        -- 最近1周<br/>
 ,(0&lt;=cast((julianday('now') - julianday(Updatedate)) as int)  and  31&gt;=cast((julianday('now') - julianday(Updatedate)) as int)) as Latest1Month     -- 最近1个月 <br/>
 ,(0&lt;=cast((julianday('now') - julianday(Updatedate)) as int)  and  93&gt;=cast((julianday('now') - julianday(Updatedate)) as int)) as Latest3Month    -- 最近3个月<br/>
 ,(0&lt;=cast((julianday('now') - julianday(Updatedate)) as int)  and  365&gt;=cast((julianday('now') - julianday(Updatedate)) as int)) as Latest1Year    -- 最近1年<br/>
from tblWord </p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);"><br/></p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);"><br/></p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);"><span style="color: rgb(51, 51, 51); font-family: punctuation, PingFangSC-Regular, 'Microsoft Yahei', sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">查询指定月每天的销售总额和日期</span><br/><span style="color: rgb(51, 51, 51); font-family: punctuation, PingFangSC-Regular, 'Microsoft Yahei', sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">select strftime('%d',S.[RECEIP_CREATE_DATE]) as day,sum(S.[RECEIPT_RECEIVED_MONEY] ) as sumSales from SALES_RECEIPT_INFO S WHERE strftime('%m',S.[RECEIP_CREATE_DATE])='&quot;+month+&quot;' group by strftime('%d',S.[RECEIP_CREATE_DATE])</span></p><p style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; background-color: rgb(255, 255, 255);"><br/></p><p style="word-wrap: break-word; margin: 5px 0px; font-family: 'sans serif', tahoma, verdana, helvetica; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-size: 14px; background-color: rgb(255, 255, 255);">查询指定年的每个月的销售总额</p><div style="word-wrap: break-word; margin: 5px 0px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: Arial; background-color: rgb(255, 255, 255); font-size: 14px;"><div><span style="color: rgb(51, 51, 51); font-family: punctuation, PingFangSC-Regular, 'Microsoft Yahei', sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);">select strftime('%m',S.[RECEIP_CREATE_DATE]) as mounth,sum(S.[RECEIPT_RECEIVABLE_MONEY] ) as sumSales  from SALES_RECEIPT_INFO S WHERE strftime('%Y',S.[RECEIP_CREATE_DATE])='&quot;+year+&quot;' group by strftime('%m',S.[RECEIP_CREATE_DATE])</span></div></div></div></span>
</div></body></html> 